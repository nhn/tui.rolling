/*!Component-Rolling v0.0.1 | NHN Entertainment*/
!function(){ne||(ne=window.ne={}),ne.component||(ne.component={}),ne.component.Rolling=ne.util.defineClass({init:function(a,b){this._option=a,this._flow=a.flow||"next",this._isDrawn=!!a.isDrawn,this._timer=null,this.delayTime=this.delayTime||3e3,this._model=a.isDrawn?null:new ne.component.Rolling.Data(a,b),this._roller=new ne.component.Rolling.Roller(a,this._model&&this._model.getData()),a.initNum&&this.moveTo(a.initNum),a.isAuto&&this.auto()},roll:function(a,b){if(b=b||this._flow,"idle"===this._roller.status)if(this._option.isVariable){if(!a)throw new Error("roll must run with data");this.setFlow(b),this._roller.move(a)}else{var c;this.setFlow(b),this._model&&(c=this._model.changeCurrent(b),a=this._model.getData()),c||this._roller.move(a)}},setFlow:function(a){this._flow=a,this._roller.setFlow(a)},moveTo:function(a){if(this._isDrawn)return void this._roller.moveTo(a);var b,c,d,e,f,g=this._model.getDataListLength(),h=Math.min(g,a),i=Math.max(1,a),j=this._model.getCurrent();if(isNaN(Number(a)))throw new Error("#PageError moveTo method have to run with page");if(this._option.isVariable)throw new Error("#DataError : Variable Rolling can't use moveTo");for(d=this.isNegative(a-j),a=d?i:h,e=d?"prev":"next",c=Math.abs(a-j),b=this._option.duration/c,this.setFlow(e),f=0;c>f;f++)this._model.changeCurrent(e),this._roller.move(this._model.getData(),b)},isNegative:function(a){return!isNaN(a)&&0>a},stop:function(){window.clearInterval(this._timer)},auto:function(){this.stop(),this._timer=window.setInterval(ne.util.bind(function(){this._model.changeCurrent(this._flow),this._roller.move(this._model.getData())},this),this.delayTime)},attach:function(a,b){this._roller.on(a,b)},fire:function(a,b){this._roller.fire(a,b)}}),ne.component.Rolling.Data=ne.util.defineClass({init:function(a,b){this.isVariable=!!a.isVariable,this._datalist=null,this._data=null,this._current=a.initNum||1,this._isCircular=ne.util.isBoolean(a.isCircular)?a.isCircular:!0,this.mixin(this.isVariable?ne.component.Rolling.Data.remoteDataMethods:ne.component.Rolling.Data.staticDataMethods),this._initData(b)},mixin:function(a){ne.util.extend(this,a)}}),ne.component.Rolling.Data.staticDataMethods={_initData:function(a){var b,c,d=null;c=ne.util.map(a,function(c,e){var f=new ne.component.Rolling.Data.Node(c);return f.prev=d,d?d.next=f:b=f,e===a.length-1&&(f.next=b,b.prev=f),d=f,f},this),c.unshift(null),this._datalist=c},getData:function(a){return this._datalist[a||this._current].data},getDataListLength:function(){return this._datalist.length-1},getPrevData:function(a){return this._datalist[a||this._current].prev.data},getNextData:function(a){return this._datalist[a||this._current].next.data},changeCurrent:function(a){var b=this.getDataListLength();if("prev"===a){if(this._current-=1,this._current<1)return this._current=this._isCircular?b:1,!0}else if(this._current+=1,this._current>b)return this._current=this._isCircular?1:b,!0},getCurrent:function(){return this._current}},ne.component.Rolling.Data.remoteDataMethods={_initData:function(a){this._data=new ne.component.Rolling.Data.Node(a)},getData:function(){return this._data.data},setData:function(a,b){this._data[a]=new ne.component.Rolling.Data.Node(b)},severLink:function(a){var b=this._data;this._data=this._data[a],b[a]=null},getPrevData:function(){return this._data.prev&&this._data.prev.data},getNextData:function(){return this._data.next&&this._data.next.data}},ne.component.Rolling.Data.Node=function(a){this.prev=null,this.next=null,this.data=a},ne.component.Rolling.Roller=ne.util.defineClass({init:function(a,b){this._option=a,this._element=ne.util.isString(a.element)?document.getElementById(a.element):a.element,this._direction=a.direction||"horizontal",this._range="horizontal"===this._direction?"left":"top",this._motion=ne.component.Rolling.Roller.motion[a.motion||"noeffect"],this._rollunit=a.unit||"page",this._isDrawn=!!a.isDrawn,this._itemcount=a.itemcount,this._flow=a.flow||"next",this._duration=a.duration||1e3,this._isCircular=ne.util.isExisty(a.isCircular)?a.isCircular:!0,this.status="idle",this._container=null,this.panel={prev:null,center:null,next:null},this._panels=[],this._basis=null,this._distance=0,this._targets=[],this._queue=[],this._unitCount="page"===a.rollunit?1:a.unitCount||1,this._events={},this.mixin(this._isDrawn?ne.component.Rolling.Roller.moveContainerSet:ne.component.Rolling.Roller.movePanelSet),this._setContainer(),this._masking(),this._setUnitDistance(),this._isDrawn&&this._initPanel(),this._setPanel(b)},mixin:function(a){ne.util.extend(this,a)},_masking:function(){var a=this._element,b=a.style;b.position="relative",b.overflow="hidden",b.width=b.width||a.clientWidth+"px",b.height=b.height||a.clientHeight+"px"},_setUnitDistance:function(){var a,b=this._element.style;a="horizontal"===this._direction?b.width.replace("px",""):b.height.replace("px",""),"page"!==this._rollunit&&this._isDrawn&&(a=Math.ceil(a/this._itemcount)),this._distance=parseInt(a,10)},_queueing:function(a,b,c){this._queue.push({data:a,duration:b,flow:c})},setFlow:function(a){this._flow=a||this._flow||"next"},changeMotion:function(a){this._motion=ne.component.Rolling.Roller.motion[a]},_animate:function(a){var b=new Date,c=window.setInterval(function(){var d,e=new Date-b,f=e/a.duration;f>1&&(f=1),d=a.delta(f),a.step(d),1===f&&(window.clearInterval(c),a.complete())},a.delay||10)}}),ne.component.Rolling.Roller.movePanelSet={_setContainer:function(){var a,b,c,d,e=this._option,f=this._element,g=f.firstChild;e.wrapperTag?(c=e.wrapperTag&&e.wrapperTag.split(".")[0],d=e.wrapperTag&&e.wrapperTag.split(".")[1]||"",a=document.createElement(c),d&&(a.className=d),this._element.innerHTML="",this._element.appendChild(a)):(ne.util.isHTMLTag(g)&&(a=g),b=g&&g.nextSibling,ne.util.isHTMLTag(b)?a=b:(a=document.createElement("ul"),this._element.appendChild(a))),this._container=a},_setPanel:function(a){var b,c,d,e=this._container.firstChild,f=this.panel,g=this._option;ne.util.isString(g.panelTag)?(b=g.panelTag.split(".")[0],c=g.panelTag.split(".")[1]||""):(ne.util.isHTMLTag(e)||(e=e&&e.nextSibling),b=ne.util.isHTMLTag(e)?e.tagName:"li",c=e&&e.className||""),this._container.innerHTML="";for(d in f)f[d]=this._makeElement(b,c,d);f.center.innerHTML=a,this._container.appendChild(f.center)},_makeElement:function(a,b){var c=document.createElement(a);return c.className=b,c.style.position="absolute",c.style.width="100%",c.style.height="100%",c.style.left="0px",c.style.top="0px",c},_updatePanel:function(a){this.panel[this._flow||"center"].innerHTML=a},_appendMoveData:function(){var a=this._flow,b=this.panel[a],c=b.style,d=("prev"===a?-this._distance:this._distance)+"px";c[this._range]=d,this.movePanel=b,this._container.appendChild(b)},_getMoveSet:function(){var a=this._flow;return"prev"===a?[0,this._distance]:[-this._distance,0]},_getStartSet:function(){var a=this.panel,b=this._flow,c=this._range,d="prev"===b,e=d?a.prev:a.center,f=d?a.center:a.next;return[parseInt(e.style[c],10),parseInt(f.style[c],10)]},_setTarget:function(a){this._targets=[this.panel.center],"prev"===a?this._targets.unshift(this.panel[a]):this._targets.push(this.panel[a])},move:function(a,b,c){if(c=c||this._flow,"idle"!==this.status)return void this._queueing(a,b,c);this.status="run";var d=this.fire("beforeMove",{data:a});return d?(this._updatePanel(a),this._appendMoveData(),this._setTarget(c),void(this._motion?this._moveWithMotion(b):this._moveWithoutMotion())):void(this.status="idle")},_moveWithoutMotion:function(){var a=this._flow,b=this._getMoveSet(a),c=this._range;ne.util.forEach(this._targets,function(a,d){a.style[c]=b[d]+"px"}),this.complete()},_moveWithMotion:function(a){var b=this._flow,c=this._getStartSet(b),d=this._distance,e=this._range;a=a||this._duration,this._animate({delay:10,duration:a||1e3,delta:this._motion,step:ne.util.bind(function(a){ne.util.forEach(this._targets,function(f,g){var h="prev"===b?d*a:-(d*a);f.style[e]=c[g]+h+"px"})},this),complete:ne.util.bind(this.complete,this)})},complete:function(){var a,b=this.panel,c=this._flow;if(a=b.center,b.center=b[c],b[c]=a,this._targets=null,this._container.removeChild(a),this.status="idle",ne.util.isNotEmpty(this._queue)){var d=this._queue.shift();this.move(d.data,d.duration,d.flow)}else this.fire("afterMove")}},ne.component.Rolling.Roller.moveContainerSet={_setContainer:function(){var a,b=this._element,c=b.firstChild;this._isDrawn&&(a=ne.util.isHTMLTag(c)?c:c.nextSibling,this._container=a,this._container.style[this._range]=0),this._setItemCount()},_isLimitPoint:function(a){var b=this._getCurrentPosition();return"next"===a?this.limit>-b?!1:!0:0>b?!1:!0},_getCurrentPosition:function(){return parseInt(this._container.style[this._range],10)},move:function(a,b){if(b=b||this._flow,"idle"!==this.status)return void this._queueing(a,b);this.status="run";var c=this.invoke("beforeMove");return c?!this._isCircular&&this._isLimitPoint(b)?void(this.status="idle"):(this._isCircular&&this._rotatePanel(b),void(this._motion?this._moveWithMotion(a):this._moveWithoutMotion())):void(this.status="idle")},complete:function(){this._isCircular&&this._setPanel(),this.status="idle"},_getMoveDistance:function(a){var b=this._getCurrentPosition(),c=this._distance*this._unitCount;return"prev"===a?this._isCircular?this._distance:b+c>0?-b:c:this._isCircular?-this._distance:c>this.limit+b?-this.limit-b:-c},_moveWithoutMotion:function(){var a=this._flow,b=this._getMoveDistance(a),c=this._range,d=parseInt(this._container.style[c],10);this._container.style[c]=d+b+"px",this.complete()},_moveWithMotion:function(a){var b=this._flow,c=this._container,d=this._range,e=parseInt(c.style[d],10),f=this._getMoveDistance(b);a=a||this._duration,this._animate({delay:10,duration:a||1e3,delta:this._motion,step:ne.util.bind(function(a){var b=f*a;c.style[d]=e+b+"px"},this),complete:ne.util.bind(this.complete,this)})},_rotatePanel:function(a){a=a||this._flow;var b,c,d,e,f=this._range,g="prev"===a,h=this._basis;return this._setPartOfPanels(a),c=this._movePanelSet,d=c.length,e=this._getMoveDistance(a),this._isInclude(this._panels[this._basis],c)?void(this._basis=g?h-d:h+d):(g?(b=this._panels[0],ne.util.forEach(c,function(a){this._container.insertBefore(a,b)},this)):ne.util.forEach(c,function(a){this._container.appendChild(a)},this),void(this._container.style[f]=parseInt(this._container.style[f],10)-e+"px"))},_isInclude:function(a,b){var c,d;for(c=0,d=b.length;d>c;c++)if(b[c]===a)return!0},_setPartOfPanels:function(a){var b=this._itemcount,c="prev"===a,d="page"!==this._rollunit?1:b,e=c?-d:d,f=c?[e]:[0,e];this._movePanelSet=this._panels.slice.apply(this._panels,f)},_setItemCount:function(){var a=this._element,b=a.style,c=parseInt(b.width||a.clientWidth,10),d=parseInt(b.height||a.clientHeight,10),e=this._element.getElementsByTagName("li")[0],f=e.style,g=parseInt(f.width||e.clientWidth,10),h=parseInt(f.height||e.clientHeight,10);this._itemcount=Math.round("left"===this._range?c/g:d/h)},_initPanel:function(){var a=this._container,b=a.childNodes;b=ne.util.toArray(b),this._panels=ne.util.filter(b,function(a){return ne.util.isHTMLTag(a)}),ne.util.forEach(this._panels,function(a,b){a.className+=" __index"+b+"__"})},_setPanel:function(){var a=this._container,b=a.childNodes;b=ne.util.toArray(b),this._panels=ne.util.filter(b,function(a){return ne.util.isHTMLTag(a)}),this._basis=this._basis||0,this._setBoundary()},_setBoundary:function(){var a=this._panels,b=this._distance,c=this._range,d=parseInt(this._element.style["left"===c?"width":"height"],10),e="page"===this._rollunit?b/this._itemcount:b*a.length,f=e-d;this.limit=f},_checkPagePosition:function(a){var b=null,c=this._panels;return ne.util.forEach(c,function(c,d){-1!==c.className.indexOf("__index"+a)&&(ne.util.isExisty(b)||(b=d))}),b},moveTo:function(a){a=Math.max(a,0),a=Math.min(a,this._panels.length-1);var b=this._checkPagePosition(a),c=this._itemcount,d=this._panels.length,e=this._distance,f="page"===this._rollunit?e/c:e,g=-b*f;this._isCircular?(g=Math.max(g,-(f*(d-c))),this._basis=b,this._setPanel()):g=Math.max(g,-this.limit),this._container.style[this._range]=g+"px"}},ne.util.CustomEvents.mixin(ne.component.Rolling.Roller),ne.component.Rolling.Roller.motion=function(){function a(a){return function(b){return a(b)}}function b(a){return function(b){return 1-a(1-b)}}function c(a){return function(b){return.5>b?a(2*b)/2:(2-a(2*(1-b)))/2}}function d(a){return a}function e(a){return Math.pow(a,2)}function f(a){return 1-Math.sin(Math.acos(a))}var g,h,i,j,k,l;return g=a(e),h=a(f),i=b(e),j=b(f),k=c(e),l=c(f),{linear:d,easeIn:g,easeOut:i,easeInOut:k,quadEaseIn:g,quadEaseOut:i,quadEaseInOut:k,circEaseIn:h,circEaseOut:j,circEaseInOut:l}}()}();
//# sourceMappingURL=rolling.min.map